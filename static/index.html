<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Grid</title>
<style>
  html,body{height:100%;margin:0}
  #c{display:block;width:100%;height:100%}
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>
const canvas=document.getElementById('c')
const ctx=canvas.getContext('2d')
let dpr=window.devicePixelRatio||1
function size(){const r=canvas.getBoundingClientRect();canvas.width=Math.max(1,Math.round(r.width*dpr));canvas.height=Math.max(1,Math.round(r.height*dpr));}
let tile=32
let zoom=0
let originX=0
let originY=0
let pan=false
let lastX=0,lastY=0
function draw(){const r=canvas.getBoundingClientRect();ctx.setTransform(dpr,0,0,dpr,0,0);ctx.clearRect(0,0,r.width,r.height);const scale=Math.pow(2,zoom);const spacing=tile*scale;ctx.strokeStyle='rgba(0,0,0,0.25)';ctx.lineWidth=1;let startX=(( -originX)%spacing+spacing)%spacing;for(let x=startX;x<=r.width;x+=spacing){ctx.beginPath();ctx.moveTo(Math.round(x)+0.5,0);ctx.lineTo(Math.round(x)+0.5,r.height);ctx.stroke()}let startY=(( -originY)%spacing+spacing)%spacing;for(let y=startY;y<=r.height;y+=spacing){ctx.beginPath();ctx.moveTo(0,Math.round(y)+0.5);ctx.lineTo(r.width,Math.round(y)+0.5);ctx.stroke()}}
window.addEventListener('resize',()=>{size();draw()})
canvas.addEventListener('mousedown',e=>{pan=true;lastX=e.clientX;lastY=e.clientY})
window.addEventListener('mouseup',()=>{pan=false})
window.addEventListener('mousemove',e=>{if(!pan)return;originX+=e.clientX-lastX;originY+=e.clientY-lastY;lastX=e.clientX;lastY=e.clientY;draw()})
canvas.addEventListener('wheel',e=>{e.preventDefault();const rect=canvas.getBoundingClientRect();const mx=e.clientX-rect.left;const my=e.clientY-rect.top;const prevScale=Math.pow(2,zoom);const step=e.deltaY<0?0.25:-0.25;zoom=Math.min(6,Math.max(-6,zoom+step));const scale=Math.pow(2,zoom);originX=mx-(mx-originX)*(scale/prevScale);originY=my-(my-originY)*(scale/prevScale);draw()},{passive:false})
size();draw()
</script>
</body>
</html>
